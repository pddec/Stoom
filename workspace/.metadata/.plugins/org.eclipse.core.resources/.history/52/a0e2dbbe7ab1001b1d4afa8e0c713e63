package br.com.stoom.CRUD;

import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.Before;
import org.junit.jupiter.api.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.transaction.annotation.Transactional;

import br.com.stoom.CRUD.dto.AddressDTO;
import br.com.stoom.CRUD.dto.AddressDTO.BuilderAddressDTO;
import br.com.stoom.CRUD.models.Address;
import br.com.stoom.CRUD.services.interfaces.Services;

@RunWith(SpringJUnit4ClassRunner.class) 
@Transactional 
@ActiveProfiles("test")
@SpringBootTest()
class CrudApplicationTests {
	
	
	@Autowired
	private Services<AddressDTO,Address> addressService;
	
	private AddressDTO addressDTO;

	private Long id;

	@Before
	void before() {
		this.addressDTO = BuilderAddressDTO.create()
				.setCity("Campinas")
				.setState("SÃ£o Paulo")
				.setComplement("12")
				.setCountry("Brasil")
				.setNeighbourhood("Fazenda Santa Candida")
				.setNumber("1395")
				.setStreetName("Rua Mirta Coluccini Porto")
				.setZipcode("13087606")
				.setLatitude("")
				.setLongitude("")
				.build();
	}
	
	@Test
	void testCreate() {
		
		Address address = addressService.executeCreate(this.addressDTO);
		
		this.id = address.getId();
		
		assertEquals(addressDTO.getCity(), address.getCity());
		assertEquals(addressDTO.getComplement(), address.getComplement());
		assertEquals(addressDTO.getCountry(), address.getCountry());
		assertEquals(addressDTO.getNeighbourhood(), address.getNeighbourhood());
		assertEquals(addressDTO.getNumber(), address.getNumber());
		assertEquals(addressDTO.getState(), address.getStreetName());
		assertEquals(addressDTO.getStreetName(), address.getStreetName());
//		assertEquals(addressDTO.getLatitude(), address.getLatitude());
//		assertEquals(addressDTO.getLongitude(), address.getLongitude());
		assertEquals(addressDTO.getZipcode(), address.getZipcode());
		
	}

}
